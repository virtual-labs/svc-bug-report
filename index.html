<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script type="module" src="client/src/bug-report.js"></script>
    <title>Document</title>
  </head>
  <body>
    <h1>Test Bug Report</h1>
    <bug-report
      id="bug-report"
      title="Virtual Labs Bug Report"
      page-type="SIMULATION"
    >
    </bug-report>

    <!-- Page Content -->
    <h1>Hello World</h1>
    <h2>This is a test page</h2>
    <div id="image-container" style = "display: flex; justify-content: center; align-items: center; width: 100%; height: 100%;"></div>
    <script>
      // pure javascript
      let object;
      let obj2 = {
        organisation: "Virtual Labs",
        developer_institute: "IIITH",
        expname: "Merge Sort",
        labname: "DS",
        phase: "2",
      };
      let httpRequest = new XMLHttpRequest(); // asynchronous request
      httpRequest.open("GET", "./questions.json", true);
      httpRequest.send();
      httpRequest.addEventListener("readystatechange", function () {
        if (this.readyState === this.DONE) {
          // when the request has completed
          object = JSON.parse(this.response);
          console.log(object);
          document
            .getElementsByTagName("bug-report")[0]
            .setAttribute("checkbox-json", JSON.stringify(object));
          document
            .getElementsByTagName("bug-report")[0]
            .setAttribute("context-info", JSON.stringify(obj2));
          document
            .getElementsByTagName("bug-report")[0]
            .addEventListener("bugreport_success", (event) => {
              console.log(event);
            });
        }
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script>
      let ele = document.body;
      // Take full page screenshot
      domtoimage.toPng(ele).then(function (dataUrl) {
        let img = new Image();
        img.src = dataUrl;
        document.getElementById("image-container").appendChild(img);
      });
    </script>
  </body>
</html>
